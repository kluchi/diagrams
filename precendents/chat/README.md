# Отправка сообщений

**Название прецедента:** Отправка сообщений

**Действующие лица:** Пользователь 1, Пользователь 2

**Цель:** Отправить сообщение от имени Пользователя 1 Пользователю 2

**Предусловия:** Пользователи зарегистрированы, Пользователи авторизованы в системе

**Главная последовательность:**

1. Пользователь нажимает на кнопку "Сообщения" на главной странице
2. Пользователю отображается список людей, с которыми он ране вёл переписку, а также поле для поиска
3. Пользователь выбирает Пользователя 2
4. Пользователю показывается меню переписки, содержащее поле для ввода сообщения, кнопку отправить, а также отображается часть истории переписки, содержащая недавно отправленные сообщения (сервер отправляет до 100 сообщений в одном запросе и присылает дополнительные по мере запроса со стороны клиента, загрузка сообщений занимает не более 300 мс)
5. Пользователь вводит сообщение в поле для ввода и нажимает отправить
6. Данные отправляются на сервер, сообщения сохраняются в базе данных
7. Пользователь 2 получает звуковое уведомление, что получено новое сообщение. В случае, если Пользователь 2 на момент отправки сообщений находится не в сети, уведомление воспроизводить не требуется.

**Альтернативная последовательность (Пользователи ранее не общались):**

1. Пользователь нажимает на кнопку "Сообщения" на главной странице
2. Пользователю отображается список людей, с которыми он ране вёл переписку, а также поле для поиска
3. Пользователь вводит данные Пользователя 2 в поле поиска
4. Пользователь выбирает Пользователя 2 из результатов поиска (поиск занимает не более 500 мс)
5. Пользователю показывается меню переписки, содержащее поле для ввода сообщения, кнопку отправить, а также отображается часть истории переписки, содержащая недавно отправленные сообщения (сервер отправляет до 100 сообщений в одном запросе и присылает дополнительные по мере запроса со стороны клиента, загрузка сообщений занимает не более 300 мс)
6. Пользователь вводит сообщение в поле для ввода и нажимает отправить
7. Данные отправляются на сервер, сообщения сохраняются в базе данных
8. Пользователь 2 получает звуковое уведомление, что получено новое сообщение. В случае, если Пользователь 2 на момент отправки сообщений находится не в сети, уведомление воспроизводить не требуется.

**Альтернативная последовательность (Пользователь получает сообщение от Пользователя 2):**

1. Пользователь 2 отправляет Пользователю 1 сообщение
2. Пользователь 1 при открытии главной страницы видит индикатор получения нового сообщения
3. Пользователь 1 нажимает на кнопку "Сообщения" на главной странице
4. Пользователю отображается список людей, с которыми он ране вёл переписку, а также поле для поиска. Рядом с элементом списка, соответствующим Пользователю 2, выводится индикатор наличия новых сообщений.
5. Пользователь выбирает Пользователя 2
6. Пользователю показывается меню переписки, содержащее поле для ввода сообщения, кнопку отправить, а также отображается часть истории переписки, содержащая недавно отправленные сообщения, в том числе и новые сообщения от Пользователя 2 (сервер отправляет до 100 сообщений в одном запросе и присылает дополнительные по мере запроса со стороны клиента, загрузка сообщений занимает не более 300 мс)
